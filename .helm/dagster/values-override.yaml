########################################################################################
# Dagster Cloud: Config for Dagster Cloud's hosted resources
########################################################################################
dagsterCloud:
  # Specify the Dagster Cloud deployments (e.g. dev, staging, prod) that the agent
  # should serve.
  deployments:
    - prod

  # Specify whether the agent should also serve branch deployments for your
  # organization.
  branchDeployments: true

########################################################################################
# Dagster Cloud Agent: Configuration for the Dagster Cloud (User) Agent
########################################################################################
dagsterCloudAgent:
  # Additional environment variables to set.
  # A Kubernetes ConfigMap will be created with these environment variables. See:
  # https://kubernetes.io/docs/concepts/configuration/configmap/
  env:
    DAGSTER_GRPC_TIMEOUT_SECONDS: "240"

########################################################################################
# Workspace: Configuration for pods (launched by the agent) that run Dagster user code
########################################################################################
workspace:
  # Specify TTL for user code servers.
  # By default full deployment servers do not have a TTL.
  # Branch deployments servers have a default TTL of 24 hours.
  # The max code servers defaults to 25, and only applies to servers with TTL.
  serverTTL:
    fullDeployments:
      enabled: true
      ttlSeconds: 300
    branchDeployments:
      ttlSeconds: 300

  # Default compute resource requirements for the pods created by the agent.
  # See: https://kubernetes.io/docs/concepts/configuration/manage-resources-containers
  resources:
    limits:
      cpu: 500m
      memory: 1.0Gi
    requests:
      cpu: 500m
      memory: 1.0Gi

  # Raw k8s configuration for the Kubernetes Job and Pod created for each run. See:
  # https://docs.dagster.io/deployment/guides/kubernetes/customizing-your-deployment
  runK8sConfig:
    podTemplateSpecMetadata: # raw config for the pod's metadata
      annotations:
        cluster-autoscaler.kubernetes.io/safe-to-evict: "false"
