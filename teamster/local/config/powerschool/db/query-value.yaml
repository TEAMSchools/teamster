resources:
  db:
    config:
      prefetchrows: 100000
ops:
  compose_queries:
    config:
      destination:
        type: gcs
      queries:
        - sql:
            schema:
              select:
                - CONSEQUENCE
                - CUSTOM
                - DCID
                - DISCIPLINE_ACTIONTAKEN
                - ENTRY
                - ENTRY_AUTHOR
                - ENTRY_TIME
                - ID
                - LOGTYPEID
                - PSGUID
                - SCHOOLID
                - STUDENTID
                - STUDENT_NUMBER
                - SUBJECT
                - SUBTYPE
                - TEACHERID
                - CATEGORY
                # - ENTRY_DATE
                - DISCIPLINE_ACTIONDATE
                - DISCIPLINE_ACTIONTAKENDETAIL
                - DISCIPLINE_ACTIONTAKENENDDATE
                - DISCIPLINE_ADMINISTRATORID
                - DISCIPLINE_ALCOHOLRELATEDFLAG
                - DISCIPLINE_DRUGRELATEDFLAG
                - DISCIPLINE_DRUGTYPEDETAIL
                - DISCIPLINE_DURATIONACTUAL
                - DISCIPLINE_DURATIONASSIGNED
                - DURATIONCHANGESOURCE
                - DISCIPLINE_DURATIONNOTES
                - DISCIPLINE_FELONYFLAG
                - DISCIPLINE_GANGRELATEDFLAG
                - DISCIPLINE_HATECRIMEFLAG
                - DISCIPLINE_HEARINGOFFICERFLAG
                - DISCIPLINE_INCIDENTCONTEXT
                - DISCIPLINE_INCIDENTDATE
                - DISCIPLINE_INCIDENTLOCATION
                - DISCIPLINE_INCIDENTLOCDETAIL
                - DISCIPLINE_INCIDENTTYPE
                - INCIDENTTYPECATEGORY
                - DISCIPLINE_INCIDENTTYPEDETAIL
                - DISCIPLINE_LIKELYINJURYFLAG
                - DISCIPLINE_MONEYLOSSVALUE
                - DISCIPLINE_OFFENDER
                - DISCIPLINE_POLICEINVOLVEDFLAG
                - DISCIPLINE_REPORTER
                - DISCIPLINE_REPORTERID
                - DISCIPLINE_SCHOOLRULESVIOFLAG
                - DISCIPLINE_SEQUENCE
                - DISCIPLINE_VICTIMTYPE
                - DISCIPLINE_WEAPONRELATEDFLAG
                - DISCIPLINE_WEAPONTYPE
                - DISCIPLINE_WEAPONTYPENOTES
              table:
                name: LOG
  execute_query:
    ops:
      extract:
        config:
          remote_port:
            env: PS_SSH_REMOTE_BIND_PORT
          remote_host:
            env: PS_SSH_REMOTE_BIND_HOST
          local_port:
            env: PS_DB_PORT
