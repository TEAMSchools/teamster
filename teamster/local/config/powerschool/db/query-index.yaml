resources:
  db:
    config:
      prefetchrows: 100000
ops:
  compose_queries:
    config:
      destination:
        type: gcs
      queries:
        - sql:
            schema:
              table:
                name: BELL_SCHEDULE
        - sql:
            schema:
              table:
                name: CALENDAR_DAY
        - sql:
            schema:
              table:
                name: CYCLE_DAY
        - sql:
            schema:
              table:
                name: PERIOD        
        - sql:
            schema:
              table:
                name: ASSIGNMENTCATEGORYASSOC
              where: "TRANSACTION_DATE >= TO_TIMESTAMP_TZ('{TODAY}', 'YYYY-MM-DD HH24:MI:SSTZH:TZM')"
        - sql:
            schema:
              table:
                name: ASSIGNMENTSCORE
              where: "TRANSACTION_DATE >= TO_TIMESTAMP_TZ('{TODAY}', 'YYYY-MM-DD HH24:MI:SSTZH:TZM')"
        - sql:
            schema:
              table:
                name: ASSIGNMENTSECTION
              where: "TRANSACTION_DATE >= TO_TIMESTAMP_TZ('{TODAY}', 'YYYY-MM-DD HH24:MI:SSTZH:TZM')"
        - sql:
            schema:
              table:
                name: TEACHERCATEGORY
              where: "TRANSACTION_DATE >= TO_TIMESTAMP_TZ('{TODAY}', 'YYYY-MM-DD HH24:MI:SSTZH:TZM')"
  execute_query:
    ops:
      extract:
        config:
          remote_port:
            env: PS_SSH_REMOTE_BIND_PORT
          remote_host:
            env: PS_SSH_REMOTE_BIND_HOST
          local_port:
            env: PS_DB_PORT
