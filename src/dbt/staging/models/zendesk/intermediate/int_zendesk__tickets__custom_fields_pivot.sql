select
    ticket_id,

    `actual_received_date`,
    `assignee_to`,
    `assignee`,
    `category`,
    `check_cut_date`,
    `date_ordered`,
    `delivery_date`,
    `department`,
    `description`,
    `due_date`,
    `group`,
    `location`,
    `mycat`,
    `mydate`,
    `order_date`,
    `po`,
    `priority`,
    `request_status`,
    `status`,
    `subject`,
    `tech_tier`,
    `ticket_status`,
    `time_spent_last_update_sec`,
    `total_time_spent_sec`,
    `type`,
    `vendor`,
from
    {{ ref("base_zendesk__tickets__custom_fields") }} pivot (
        max(custom_field_value) for ticket_field_title in (
            'Actual Received Date' as `actual_received_date`,
            'Assignee to' as `assignee_to`,
            'Assignee' as `assignee`,
            'Category' as `category`,
            'Check Cut Date' as `check_cut_date`,
            'Date Ordered' as `date_ordered`,
            'Delivery Date' as `delivery_date`,
            'Department' as `department`,
            'Description' as `description`,
            'Due Date' as `due_date`,
            'Group' as `group`,
            'Location' as `location`,
            'MyCat' as `mycat`,
            'MyDate' as `mydate`,
            'Order Date' as `order_date`,
            'PO' as `po`,
            'Priority' as `priority`,
            'Request Status' as `request_status`,
            'Status' as `status`,
            'Subject' as `subject`,
            'Tech Tier' as `tech_tier`,
            'Ticket status' as `ticket_status`,
            'Time spent last update (sec)' as `time_spent_last_update_sec`,
            'Total time spent (sec)' as `total_time_spent_sec`,
            'Type' as `type`,
            'Vendor' as `vendor`
        )
    )
