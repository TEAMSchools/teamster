-- old files
select
    assessment,
    assessment_edition,
    school_year,
    academic_year,
    state,
    region,
    schoolid,
    school,

    official_teacher_staff_id,
    official_teacher_name,
    assessing_teacher_staff_id,
    assessing_teacher_name,

    surrogate_key,
    student_primary_id,
    student_first_name,
    student_last_name,
    assessment_grade_int,
    enrollment_grade_int,
    date_of_birth,

    benchmark_period,
    assessment_grade,
    enrollment_grade,
    client_date,
    sync_date,

    correct_responses_maze_score,
    incorrect_responses_maze_score,
    dibels_composite_score_lexile,
    error_rate_orf_score,

    ran_level,
    ran_score,
    risk_indicator_level,
    spelling_level,
    spelling_score,
    vocabulary_level,
    vocabulary_score,

    decoding_nwf_wrc_score,
    letter_names_lnf_score,
    letter_sounds_nwf_cls_score,
    phonemic_awareness_psf_score,
    reading_accuracy_orf_accu_score,
    reading_comprehension_maze_score,
    reading_fluency_orf_score,
    word_reading_wrf_score,

    composite_semester_growth,
    decoding_nwf_wrc_semester_growth,
    letter_names_lnf_semester_growth,
    letter_sounds_nwf_cls_semester_growth,
    phonemic_awareness_psf_semester_growth,
    reading_accuracy_orf_accu_semester_growth,
    reading_comprehension_maze_semester_growth,
    reading_fluency_orf_semester_growth,
    word_reading_wrf_semester_growth,
    composite_year_growth,
    decoding_nwf_wrc_year_growth,
    letter_names_lnf_year_growth,
    letter_sounds_nwf_cls_year_growth,
    phonemic_awareness_psf_year_growth,
    reading_accuracy_orf_accu_year_growth,
    reading_comprehension_maze_year_growth,
    reading_fluency_orf_year_growth,
    word_reading_wrf_year_growth,

    composite_score,

    null as composite_local_percentile,
    null as decoding_nwf_wrc_local_percentile,
    null as letter_names_lnf_local_percentile,
    null as letter_sounds_nwf_cls_local_percentile,
    null as phonemic_awareness_psf_local_percentile,
    null as reading_accuracy_orf_accu_local_percentile,
    null as reading_comprehension_maze_local_percentile,
    null as reading_fluency_orf_local_percentile,
    null as word_reading_wrf_local_percentile,

    composite_national_norm_percentile,
    decoding_nwf_wrc_national_norm_percentile,
    letter_names_lnf_national_norm_percentile,
    letter_sounds_nwf_cls_national_norm_percentile,
    phonemic_awareness_psf_national_norm_percentile,
    reading_accuracy_orf_accu_national_norm_percentile,
    reading_comprehension_maze_national_norm_percentile,
    reading_fluency_orf_national_norm_percentile,
    word_reading_wrf_national_norm_percentile,

    composite_level,
    decoding_nwf_wrc_level,
    letter_names_lnf_level,
    letter_sounds_nwf_cls_level,
    phonemic_awareness_psf_level,
    reading_accuracy_orf_accu_level,
    reading_comprehension_maze_level,
    reading_fluency_orf_level,
    word_reading_wrf_level,

    composite_tested_out,
    decoding_nwf_wrc_tested_out,
    letter_names_lnf_tested_out,
    letter_sounds_nwf_cls_tested_out,
    phonemic_awareness_psf_tested_out,
    reading_accuracy_orf_accu_tested_out,
    reading_comprehension_maze_tested_out,
    reading_fluency_orf_tested_out,
    word_reading_wrf_tested_out,

    composite_discontinued,
    decoding_nwf_wrc_discontinued,
    letter_names_lnf_discontinued,
    letter_sounds_nwf_cls_discontinued,
    phonemic_awareness_psf_discontinued,
    reading_accuracy_orf_accu_discontinued,
    reading_comprehension_maze_discontinued,
    reading_fluency_orf_discontinued,
    word_reading_wrf_discontinued,

from {{ ref("stg_amplify__benchmark_student_summary") }}

union all

-- new files
select
    assessment,
    assessment_edition,
    school_year,
    academic_year,
    state,
    region,
    schoolid,
    school,

    enrollment_teacher_staff_id as official_teacher_staff_id,
    enrollment_teacher_name as official_teacher_name,
    assessing_teacher_staff_id,
    assessing_teacher_name,

    surrogate_key,
    student_primary_id,
    student_first_name,
    student_last_name,
    assessment_grade_int,
    enrollment_grade_int,
    date_of_birth,

    benchmark_period,
    assessment_grade,
    enrollment_grade,
    device_date as client_date,
    sync_date,

    correct_responses_maze_score,
    incorrect_responses_maze_score,
    composite_score_lexile as dibels_composite_score_lexile,
    error_rate_orf_score,

    ran_level,
    ran_score,
    risk_indicator_level,
    spelling_level,
    spelling_score,
    vocabulary_level,
    vocabulary_score,

    decoding_nwf_wrc_score,
    letter_names_lnf_score,
    letter_sounds_nwf_cls_score,
    phonemic_awareness_psf_score,
    reading_accuracy_orf_accu_score,
    basic_comprehension_maze_score as reading_comprehension_maze_score,
    reading_fluency_orf_score,
    word_reading_wrf_score,

    composite_semester_growth,
    decoding_nwf_wrc_semester_growth,
    letter_names_lnf_semester_growth,
    letter_sounds_nwf_cls_semester_growth,
    phonemic_awareness_psf_semester_growth,
    reading_accuracy_orf_accu_semester_growth,
    basic_comprehension_maze_semester_growth
    as reading_comprehension_maze_semester_growth,
    reading_fluency_orf_semester_growth,
    word_reading_wrf_semester_growth,
    composite_year_growth,
    decoding_nwf_wrc_year_growth,
    letter_names_lnf_year_growth,
    letter_sounds_nwf_cls_year_growth,
    phonemic_awareness_psf_year_growth,
    reading_accuracy_orf_accu_year_growth,
    basic_comprehension_maze_year_growth as reading_comprehension_maze_year_growth,
    reading_fluency_orf_year_growth,
    word_reading_wrf_year_growth,

    composite_score,

    composite_local_percentile,
    decoding_nwf_wrc_local_percentile,
    letter_names_lnf_local_percentile,
    letter_sounds_nwf_cls_local_percentile,
    phonemic_awareness_psf_local_percentile,
    reading_accuracy_orf_accu_local_percentile,
    basic_comprehension_maze_local_percentile
    as reading_comprehension_maze_local_percentile,
    reading_fluency_orf_local_percentile,
    word_reading_wrf_local_percentile,

    composite_national_norm_percentile,
    decoding_nwf_wrc_national_norm_percentile,
    letter_names_lnf_national_norm_percentile,
    letter_sounds_nwf_cls_national_norm_percentile,
    phonemic_awareness_psf_national_norm_percentile,
    reading_accuracy_orf_accu_national_norm_percentile,
    basic_comprehension_maze_national_norm_percentile
    as reading_comprehension_maze_national_norm_percentile,
    reading_fluency_orf_national_norm_percentile,
    word_reading_wrf_national_norm_percentile,

    composite_level,
    decoding_nwf_wrc_level,
    letter_names_lnf_level,
    letter_sounds_nwf_cls_level,
    phonemic_awareness_psf_level,
    reading_accuracy_orf_accu_level,
    basic_comprehension_maze_level as reading_comprehension_maze_level,
    reading_fluency_orf_level,
    word_reading_wrf_level,

    composite_tested_out,
    decoding_nwf_wrc_tested_out,
    letter_names_lnf_tested_out,
    letter_sounds_nwf_cls_tested_out,
    phonemic_awareness_psf_tested_out,
    reading_accuracy_orf_accu_tested_out,
    basic_comprehension_maze_tested_out as reading_comprehension_maze_tested_out,
    reading_fluency_orf_tested_out,
    word_reading_wrf_tested_out,

    composite_discontinued,
    decoding_nwf_wrc_discontinued,
    letter_names_lnf_discontinued,
    letter_sounds_nwf_cls_discontinued,
    phonemic_awareness_psf_discontinued,
    reading_accuracy_orf_accu_discontinued,
    basic_comprehension_maze_discontinued as reading_comprehension_maze_discontinued,
    reading_fluency_orf_discontinued,
    word_reading_wrf_discontinued,

from {{ ref("stg_amplify__mclass__sftp__benchmark_student_summary") }}
