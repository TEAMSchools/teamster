select
    _dbt_source_relation,
    yearid,
    academic_year,
    region,
    schoolid,
    school_level,
    teacher_number,
    teacher_name,
    course_number,
    section_or_period,
    sectionid,
    sections_dcid,
    teacher_quarter,
    expected_teacher_assign_category_code,
    expected_teacher_assign_category_name,
    audit_yr_week_number,
    audit_qt_week_number,
    audit_start_date,
    audit_end_date,
    audit_due_date,
    audit_category_exp_audit_week_ytd,
    teacher_assign_id,
    teacher_assign_name,
    teacher_assign_score_type,
    teacher_assign_max_score,
    teacher_assign_due_date,
    teacher_assign_count,
    teacher_running_total_assign_by_cat,
    teacher_avg_score_for_assign_per_class_section_and_assign_id,
    total_expected_actual_graded_assignments_by_cat_qt_audit_week_all_courses,
    total_expected_graded_assignments_by_cat_qt_audit_week_all_courses,
    total_expected_actual_graded_assignments_by_course_cat_qt_audit_week,
    total_expected_graded_assignments_by_course_cat_qt_audit_week,
    total_expected_actual_graded_assignments_by_course_assign_id_qt_audit_week,
    total_expected_graded_assignments_by_course_assign_id_qt_audit_week,
    percent_graded_completion_by_cat_qt_audit_week_all_courses,
    percent_graded_completion_by_cat_qt_audit_week,
    percent_graded_completion_by_assign_id_qt_audit_week,

    teacher_flag_name,
    teacher_flag_value,
from
    {{ ref("int_powerschool__teacher_assignments") }} unpivot (
        teacher_flag_value for teacher_flag_name in (
            qt_teacher_no_missing_assignments,
            qt_teacher_s_total_less_200,
            qt_teacher_s_total_greater_200,
            assign_max_score_not_10,
            max_score_greater_100,
            expected_assign_count_not_met
        )
    )
where teacher_flag_value
