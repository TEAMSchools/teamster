with
    pre_pivot as (
        select
            respondent_email,
            response_id,
            last_submitted_time,
            item_abbreviation,
            `value`,
        from {{ ref("base_google_forms__form_responses") }}
        where
            info_document_title = 'Staff Info & Certification Update'
            and not is_null_value
            and rn_form_item_respondent_submitted_desc = 1
    )

select
    respondent_email,
    response_id,
    last_submitted_time,

    {# pivot cols #}
    additional_languages,
    alumni_status,
    cert_barriers,
    cert_out_of_state_details,
    cert_required,
    cert_status,
    cert_steps_taken,
    community_grew_up,
    community_professional_exp,
    fl_additional_cert_1,
    fl_cert_endorsement_1,
    fl_cert_endorsement_2,
    fl_cert_endorsement_3,
    fl_cert_endorsement_4,
    fl_cert_endorsement_5,
    fl_cert_expiration_1,
    fl_cert_expiration_2,
    fl_cert_expiration_3,
    fl_cert_expiration_4,
    fl_cert_expiration_5,
    fl_open_to_student_teacher,
    gender_identity,
    languages_spoken,
    level_of_educatation,
    nj_cert_additional_1,
    nj_cert_document_link_1,
    nj_cert_document_link_2,
    nj_cert_document_link_3,
    nj_cert_document_link_4,
    nj_cert_document_link_5,
    nj_cert_endorsement_1,
    nj_cert_endorsement_2,
    nj_cert_endorsement_3,
    nj_cert_endorsement_4,
    nj_cert_endorsement_5,
    nj_cert_issue_date_1,
    nj_cert_issue_date_2,
    nj_cert_issue_date_3,
    nj_cert_issue_date_4,
    nj_cert_issue_date_5,
    nj_cert_type_1,
    nj_cert_type_2,
    nj_cert_type_3,
    nj_cert_type_4,
    nj_cert_type_5,
    path_to_education,
    race_ethnicity,
    relay_status,
    respondent_name,
    undergraduate_school,
    years_exp_outside_kipp,
    years_teaching_in_njfl,
    years_teaching_outside_njfl,
from
    pre_pivot pivot (
        max(`value`) for item_abbreviation in (
            'additional_languages',
            'alumni_status',
            'cert_barriers',
            'cert_out_of_state_details',
            'cert_required',
            'cert_status',
            'cert_steps_taken',
            'community_grew_up',
            'community_professional_exp',
            'fl_additional_cert_1',
            'fl_cert_endorsement_1',
            'fl_cert_endorsement_2',
            'fl_cert_endorsement_3',
            'fl_cert_endorsement_4',
            'fl_cert_endorsement_5',
            'fl_cert_expiration_1',
            'fl_cert_expiration_2',
            'fl_cert_expiration_3',
            'fl_cert_expiration_4',
            'fl_cert_expiration_5',
            'fl_open_to_student_teacher',
            'gender_identity',
            'languages_spoken',
            'level_of_educatation',
            'nj_cert_additional_1',
            'nj_cert_document_link_1',
            'nj_cert_document_link_2',
            'nj_cert_document_link_3',
            'nj_cert_document_link_4',
            'nj_cert_document_link_5',
            'nj_cert_endorsement_1',
            'nj_cert_endorsement_2',
            'nj_cert_endorsement_3',
            'nj_cert_endorsement_4',
            'nj_cert_endorsement_5',
            'nj_cert_issue_date_1',
            'nj_cert_issue_date_2',
            'nj_cert_issue_date_3',
            'nj_cert_issue_date_4',
            'nj_cert_issue_date_5',
            'nj_cert_type_1',
            'nj_cert_type_2',
            'nj_cert_type_3',
            'nj_cert_type_4',
            'nj_cert_type_5',
            'path_to_education',
            'race_ethnicity',
            'relay_status',
            'respondent_name',
            'undergraduate_school',
            'years_exp_outside_kipp',
            'years_teaching_in_njfl',
            'years_teaching_outside_njfl'
        )
    )
