-- depends_on: {{ ref("stg_illuminate__repository_1") }}
-- depends_on: {{ ref("stg_illuminate__repository_10") }}
-- depends_on: {{ ref("stg_illuminate__repository_100") }}
-- depends_on: {{ ref("stg_illuminate__repository_101") }}
-- depends_on: {{ ref("stg_illuminate__repository_102") }}
-- depends_on: {{ ref("stg_illuminate__repository_103") }}
-- depends_on: {{ ref("stg_illuminate__repository_104") }}
-- depends_on: {{ ref("stg_illuminate__repository_105") }}
-- depends_on: {{ ref("stg_illuminate__repository_11") }}
-- depends_on: {{ ref("stg_illuminate__repository_110") }}
-- depends_on: {{ ref("stg_illuminate__repository_111") }}
-- depends_on: {{ ref("stg_illuminate__repository_113") }}
-- depends_on: {{ ref("stg_illuminate__repository_114") }}
-- depends_on: {{ ref("stg_illuminate__repository_115") }}
-- depends_on: {{ ref("stg_illuminate__repository_116") }}
-- depends_on: {{ ref("stg_illuminate__repository_117") }}
-- depends_on: {{ ref("stg_illuminate__repository_118") }}
-- depends_on: {{ ref("stg_illuminate__repository_119") }}
-- depends_on: {{ ref("stg_illuminate__repository_12") }}
-- depends_on: {{ ref("stg_illuminate__repository_120") }}
-- depends_on: {{ ref("stg_illuminate__repository_121") }}
-- depends_on: {{ ref("stg_illuminate__repository_122") }}
-- depends_on: {{ ref("stg_illuminate__repository_123") }}
-- depends_on: {{ ref("stg_illuminate__repository_124") }}
-- depends_on: {{ ref("stg_illuminate__repository_125") }}
-- depends_on: {{ ref("stg_illuminate__repository_126") }}
-- depends_on: {{ ref("stg_illuminate__repository_127") }}
-- depends_on: {{ ref("stg_illuminate__repository_128") }}
-- depends_on: {{ ref("stg_illuminate__repository_129") }}
-- depends_on: {{ ref("stg_illuminate__repository_13") }}
-- depends_on: {{ ref("stg_illuminate__repository_130") }}
-- depends_on: {{ ref("stg_illuminate__repository_131") }}
-- depends_on: {{ ref("stg_illuminate__repository_132") }}
-- depends_on: {{ ref("stg_illuminate__repository_133") }}
-- depends_on: {{ ref("stg_illuminate__repository_134") }}
-- depends_on: {{ ref("stg_illuminate__repository_135") }}
-- depends_on: {{ ref("stg_illuminate__repository_136") }}
-- depends_on: {{ ref("stg_illuminate__repository_137") }}
-- depends_on: {{ ref("stg_illuminate__repository_138") }}
-- depends_on: {{ ref("stg_illuminate__repository_139") }}
-- depends_on: {{ ref("stg_illuminate__repository_14") }}
-- depends_on: {{ ref("stg_illuminate__repository_140") }}
-- depends_on: {{ ref("stg_illuminate__repository_141") }}
-- depends_on: {{ ref("stg_illuminate__repository_142") }}
-- depends_on: {{ ref("stg_illuminate__repository_143") }}
-- depends_on: {{ ref("stg_illuminate__repository_144") }}
-- depends_on: {{ ref("stg_illuminate__repository_145") }}
-- depends_on: {{ ref("stg_illuminate__repository_146") }}
-- depends_on: {{ ref("stg_illuminate__repository_147") }}
-- depends_on: {{ ref("stg_illuminate__repository_148") }}
-- depends_on: {{ ref("stg_illuminate__repository_149") }}
-- depends_on: {{ ref("stg_illuminate__repository_15") }}
-- depends_on: {{ ref("stg_illuminate__repository_150") }}
-- depends_on: {{ ref("stg_illuminate__repository_151") }}
-- depends_on: {{ ref("stg_illuminate__repository_152") }}
-- depends_on: {{ ref("stg_illuminate__repository_153") }}
-- depends_on: {{ ref("stg_illuminate__repository_154") }}
-- depends_on: {{ ref("stg_illuminate__repository_155") }}
-- depends_on: {{ ref("stg_illuminate__repository_156") }}
-- depends_on: {{ ref("stg_illuminate__repository_157") }}
-- depends_on: {{ ref("stg_illuminate__repository_158") }}
-- depends_on: {{ ref("stg_illuminate__repository_159") }}
-- depends_on: {{ ref("stg_illuminate__repository_16") }}
-- depends_on: {{ ref("stg_illuminate__repository_160") }}
-- depends_on: {{ ref("stg_illuminate__repository_161") }}
-- depends_on: {{ ref("stg_illuminate__repository_162") }}
-- depends_on: {{ ref("stg_illuminate__repository_163") }}
-- depends_on: {{ ref("stg_illuminate__repository_168") }}
-- depends_on: {{ ref("stg_illuminate__repository_169") }}
-- depends_on: {{ ref("stg_illuminate__repository_17") }}
-- depends_on: {{ ref("stg_illuminate__repository_170") }}
-- depends_on: {{ ref("stg_illuminate__repository_172") }}
-- depends_on: {{ ref("stg_illuminate__repository_174") }}
-- depends_on: {{ ref("stg_illuminate__repository_175") }}
-- depends_on: {{ ref("stg_illuminate__repository_176") }}
-- depends_on: {{ ref("stg_illuminate__repository_177") }}
-- depends_on: {{ ref("stg_illuminate__repository_178") }}
-- depends_on: {{ ref("stg_illuminate__repository_179") }}
-- depends_on: {{ ref("stg_illuminate__repository_180") }}
-- depends_on: {{ ref("stg_illuminate__repository_181") }}
-- depends_on: {{ ref("stg_illuminate__repository_182") }}
-- depends_on: {{ ref("stg_illuminate__repository_184") }}
-- depends_on: {{ ref("stg_illuminate__repository_188") }}
-- depends_on: {{ ref("stg_illuminate__repository_189") }}
-- depends_on: {{ ref("stg_illuminate__repository_19") }}
-- depends_on: {{ ref("stg_illuminate__repository_190") }}
-- depends_on: {{ ref("stg_illuminate__repository_191") }}
-- depends_on: {{ ref("stg_illuminate__repository_192") }}
-- depends_on: {{ ref("stg_illuminate__repository_193") }}
-- depends_on: {{ ref("stg_illuminate__repository_194") }}
-- depends_on: {{ ref("stg_illuminate__repository_195") }}
-- depends_on: {{ ref("stg_illuminate__repository_196") }}
-- depends_on: {{ ref("stg_illuminate__repository_197") }}
-- depends_on: {{ ref("stg_illuminate__repository_198") }}
-- depends_on: {{ ref("stg_illuminate__repository_199") }}
-- depends_on: {{ ref("stg_illuminate__repository_2") }}
-- depends_on: {{ ref("stg_illuminate__repository_20") }}
-- depends_on: {{ ref("stg_illuminate__repository_200") }}
-- depends_on: {{ ref("stg_illuminate__repository_201") }}
-- depends_on: {{ ref("stg_illuminate__repository_202") }}
-- depends_on: {{ ref("stg_illuminate__repository_203") }}
-- depends_on: {{ ref("stg_illuminate__repository_204") }}
-- depends_on: {{ ref("stg_illuminate__repository_206") }}
-- depends_on: {{ ref("stg_illuminate__repository_207") }}
-- depends_on: {{ ref("stg_illuminate__repository_208") }}
-- depends_on: {{ ref("stg_illuminate__repository_209") }}
-- depends_on: {{ ref("stg_illuminate__repository_21") }}
-- depends_on: {{ ref("stg_illuminate__repository_213") }}
-- depends_on: {{ ref("stg_illuminate__repository_214") }}
-- depends_on: {{ ref("stg_illuminate__repository_215") }}
-- depends_on: {{ ref("stg_illuminate__repository_216") }}
-- depends_on: {{ ref("stg_illuminate__repository_217") }}
-- depends_on: {{ ref("stg_illuminate__repository_22") }}
-- depends_on: {{ ref("stg_illuminate__repository_221") }}
-- depends_on: {{ ref("stg_illuminate__repository_222") }}
-- depends_on: {{ ref("stg_illuminate__repository_223") }}
-- depends_on: {{ ref("stg_illuminate__repository_224") }}
-- depends_on: {{ ref("stg_illuminate__repository_225") }}
-- depends_on: {{ ref("stg_illuminate__repository_226") }}
-- depends_on: {{ ref("stg_illuminate__repository_227") }}
-- depends_on: {{ ref("stg_illuminate__repository_228") }}
-- depends_on: {{ ref("stg_illuminate__repository_229") }}
-- depends_on: {{ ref("stg_illuminate__repository_23") }}
-- depends_on: {{ ref("stg_illuminate__repository_230") }}
-- depends_on: {{ ref("stg_illuminate__repository_231") }}
-- depends_on: {{ ref("stg_illuminate__repository_232") }}
-- depends_on: {{ ref("stg_illuminate__repository_233") }}
-- depends_on: {{ ref("stg_illuminate__repository_234") }}
-- depends_on: {{ ref("stg_illuminate__repository_235") }}
-- depends_on: {{ ref("stg_illuminate__repository_236") }}
-- depends_on: {{ ref("stg_illuminate__repository_237") }}
-- depends_on: {{ ref("stg_illuminate__repository_238") }}
-- depends_on: {{ ref("stg_illuminate__repository_239") }}
-- depends_on: {{ ref("stg_illuminate__repository_24") }}
-- depends_on: {{ ref("stg_illuminate__repository_240") }}
-- depends_on: {{ ref("stg_illuminate__repository_241") }}
-- depends_on: {{ ref("stg_illuminate__repository_242") }}
-- depends_on: {{ ref("stg_illuminate__repository_243") }}
-- depends_on: {{ ref("stg_illuminate__repository_244") }}
-- depends_on: {{ ref("stg_illuminate__repository_245") }}
-- depends_on: {{ ref("stg_illuminate__repository_246") }}
-- depends_on: {{ ref("stg_illuminate__repository_247") }}
-- depends_on: {{ ref("stg_illuminate__repository_248") }}
-- depends_on: {{ ref("stg_illuminate__repository_249") }}
-- depends_on: {{ ref("stg_illuminate__repository_25") }}
-- depends_on: {{ ref("stg_illuminate__repository_250") }}
-- depends_on: {{ ref("stg_illuminate__repository_251") }}
-- depends_on: {{ ref("stg_illuminate__repository_252") }}
-- depends_on: {{ ref("stg_illuminate__repository_253") }}
-- depends_on: {{ ref("stg_illuminate__repository_254") }}
-- depends_on: {{ ref("stg_illuminate__repository_255") }}
-- depends_on: {{ ref("stg_illuminate__repository_256") }}
-- depends_on: {{ ref("stg_illuminate__repository_257") }}
-- depends_on: {{ ref("stg_illuminate__repository_258") }}
-- depends_on: {{ ref("stg_illuminate__repository_259") }}
-- depends_on: {{ ref("stg_illuminate__repository_26") }}
-- depends_on: {{ ref("stg_illuminate__repository_260") }}
-- depends_on: {{ ref("stg_illuminate__repository_261") }}
-- depends_on: {{ ref("stg_illuminate__repository_262") }}
-- depends_on: {{ ref("stg_illuminate__repository_263") }}
-- depends_on: {{ ref("stg_illuminate__repository_264") }}
-- depends_on: {{ ref("stg_illuminate__repository_265") }}
-- depends_on: {{ ref("stg_illuminate__repository_266") }}
-- depends_on: {{ ref("stg_illuminate__repository_267") }}
-- depends_on: {{ ref("stg_illuminate__repository_268") }}
-- depends_on: {{ ref("stg_illuminate__repository_269") }}
-- depends_on: {{ ref("stg_illuminate__repository_27") }}
-- depends_on: {{ ref("stg_illuminate__repository_270") }}
-- depends_on: {{ ref("stg_illuminate__repository_271") }}
-- depends_on: {{ ref("stg_illuminate__repository_272") }}
-- depends_on: {{ ref("stg_illuminate__repository_273") }}
-- depends_on: {{ ref("stg_illuminate__repository_274") }}
-- depends_on: {{ ref("stg_illuminate__repository_275") }}
-- depends_on: {{ ref("stg_illuminate__repository_276") }}
-- depends_on: {{ ref("stg_illuminate__repository_277") }}
-- depends_on: {{ ref("stg_illuminate__repository_278") }}
-- depends_on: {{ ref("stg_illuminate__repository_279") }}
-- depends_on: {{ ref("stg_illuminate__repository_280") }}
-- depends_on: {{ ref("stg_illuminate__repository_281") }}
-- depends_on: {{ ref("stg_illuminate__repository_282") }}
-- depends_on: {{ ref("stg_illuminate__repository_283") }}
-- depends_on: {{ ref("stg_illuminate__repository_284") }}
-- depends_on: {{ ref("stg_illuminate__repository_285") }}
-- depends_on: {{ ref("stg_illuminate__repository_286") }}
-- depends_on: {{ ref("stg_illuminate__repository_287") }}
-- depends_on: {{ ref("stg_illuminate__repository_288") }}
-- depends_on: {{ ref("stg_illuminate__repository_289") }}
-- depends_on: {{ ref("stg_illuminate__repository_29") }}
-- depends_on: {{ ref("stg_illuminate__repository_290") }}
-- depends_on: {{ ref("stg_illuminate__repository_291") }}
-- depends_on: {{ ref("stg_illuminate__repository_292") }}
-- depends_on: {{ ref("stg_illuminate__repository_293") }}
-- depends_on: {{ ref("stg_illuminate__repository_295") }}
-- depends_on: {{ ref("stg_illuminate__repository_299") }}
-- depends_on: {{ ref("stg_illuminate__repository_3") }}
-- depends_on: {{ ref("stg_illuminate__repository_300") }}
-- depends_on: {{ ref("stg_illuminate__repository_301") }}
-- depends_on: {{ ref("stg_illuminate__repository_302") }}
-- depends_on: {{ ref("stg_illuminate__repository_303") }}
-- depends_on: {{ ref("stg_illuminate__repository_304") }}
-- depends_on: {{ ref("stg_illuminate__repository_305") }}
-- depends_on: {{ ref("stg_illuminate__repository_306") }}
-- depends_on: {{ ref("stg_illuminate__repository_307") }}
-- depends_on: {{ ref("stg_illuminate__repository_308") }}
-- depends_on: {{ ref("stg_illuminate__repository_309") }}
-- depends_on: {{ ref("stg_illuminate__repository_31") }}
-- depends_on: {{ ref("stg_illuminate__repository_310") }}
-- depends_on: {{ ref("stg_illuminate__repository_311") }}
-- depends_on: {{ ref("stg_illuminate__repository_312") }}
-- depends_on: {{ ref("stg_illuminate__repository_313") }}
-- depends_on: {{ ref("stg_illuminate__repository_314") }}
-- depends_on: {{ ref("stg_illuminate__repository_315") }}
-- depends_on: {{ ref("stg_illuminate__repository_316") }}
{{ config(materialized="view") }}

{%- set relations = dbt_utils.get_relations_by_prefix(
    schema=model.schema,
    prefix="stg_illuminate__repository_",
    exclude="stg_illuminate__repository_%s",
) -%}

with union_relations as ({{ dbt_utils.union_relations(relations=relations) }})

select
    ur.*,

    r.title,
    r.scope,
    r.subject_area,
    r.date_administered,

    s.local_student_id,

    rf.label as field_label,
from union_relations as ur
inner join
    {{ ref("base_illuminate__repositories") }} as r
    on ur.repository_id = r.repository_id
inner join {{ ref("stg_illuminate__students") }} as s on ur.student_id = s.student_id
inner join
    {{ ref("stg_illuminate__repository_fields") }} as rf
    on ur.repository_id = rf.repository_id
    and ur.field_name = rf.name
